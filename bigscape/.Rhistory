heat[is.na(heat)] <- 0
rownames(heat) <- heat$Genome
heat$Genome <- NULL
heat_mat <- as.matrix(heat)
annotation_col = data.frame(
"BGC_Type" = sub("\\..*$", "", colnames(heat_mat)),
row.names = colnames(heat_mat)
)
ann_colors = list(
'BGC_Type' = c(NRPS = '#1B9E77', PKS1 = '#D95F02', Terpene = '#7570B3')#,
#  'Agriculture' = c(Leafcutter = 'green4', Lower = 'yellow', Coral = 'magenta3', Higher = 'blue3')
)
pheatmap(heat_mat, annotation_col = annotation_col,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
labels_row = sub("_.*$", "", rownames(heat_mat)))
all
all$Presence
terp
terp$Presence
terp <- read_tsv('terpene_absence_presence.tsv') %>%
mutate(Type = 'Terpene')
ter
terp
terp <- read_tsv('terpene_absence_presence.tsv') %>%
mutate(Type = 'Terpene') %>%
gather(FamilyID, Presence, -ACC, -Type)
terp
terp$Presence
terp <- read_tsv('terpene_absence_presence.tsv') %>%
mutate(Type = 'Terpene') %>%
gather(FamilyID, Presence, -ACC, -Type)  %>%
mutate(Genome =  munge_genome_ids(ACC))
terp <- read_tsv('terpene_absence_presence.tsv') %>%
mutate(Type = 'Terpene') %>%
mutate(Genome =  munge_genome_ids(ACC)) %>%
gather(FamilyID, Presence, -ACC, -Type)
gather(FamilyID, Presence, -ACC, -Type)
terp <- read_tsv('terpene_absence_presence.tsv') %>%
mutate(Type = 'Terpene') %>%
group_by(ACC) %>%
mutate(Genome =  munge_genome_ids(ACC)) %>%
ungroup() %>%
gather(FamilyID, Presence, -ACC, -Type)
terp
terp$Presence
terp <- read_tsv('terpene_absence_presence.tsv') %>%
mutate(Type = 'Terpene') %>%
group_by(ACC) %>%
mutate(Genome =  munge_genome_ids(ACC)) %>%
ungroup() %>%
gather(FamilyID, Presence, -ACC, -Type, -Genome)
terp$Presence
terp
pks
all <- bind_rows(nrps, pks, terp) %>%
mutate(uniq_id = paste(Type, FamilyID, sep = ".")) %>%
mutate(Presence = as.numeric(Presence)) %>%
group_by(Type, FamilyID) %>%
mutate(n_genomes = sum(Presence)) %>%
ungroup() %>%
filter(n_genomes > 1)  #%>% ## remove singletons
all
nrow(all)
table(all$n_genomes)
heat <- all %>% select(Genome, uniq_id, Presence) %>%
spread(uniq_id, Presence) %>%
data.frame()
heat
heat[is.na(heat)] <- 0
heat
heat <- all %>% select(Genome, uniq_id, Presence) %>%
spread(uniq_id, Presence) %>%
data.frame()
#heat[is.na(heat)] <- 0
rownames(heat) <- heat$Genome
heat$Genome <- NULL
heat_mat <- as.matrix(heat)
annotation_col = data.frame(
"BGC_Type" = sub("\\..*$", "", colnames(heat_mat)),
row.names = colnames(heat_mat)
)
ann_colors = list(
'BGC_Type' = c(NRPS = '#1B9E77', PKS1 = '#D95F02', Terpene = '#7570B3')#,
#  'Agriculture' = c(Leafcutter = 'green4', Lower = 'yellow', Coral = 'magenta3', Higher = 'blue3')
)
pheatmap(heat_mat, annotation_col = annotation_col,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
labels_row = sub("_.*$", "", rownames(heat_mat)))
pheatmap(heat_mat, annotation_col = annotation_col,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
labels_row = sub("_.*$", "", rownames(heat_mat)))
summary(heat)
head(heat_mat)
heat <- all %>% select(Genome, uniq_id, Presence) %>%
spread(uniq_id, Presence) %>%
data.frame()
#heat[is.na(heat)] <- 0
rownames(heat) <- heat$Genome
heat$Genome <- NULL
heat_mat <- as.matrix(heat)
annotation_col = data.frame(
"BGC_Type" = sub("\\..*$", "", colnames(heat_mat)),
row.names = colnames(heat_mat)
)
ann_colors = list(
'BGC_Type' = c(NRPS = '#1B9E77', PKS1 = '#D95F02', Terpene = '#7570B3')#,
#  'Agriculture' = c(Leafcutter = 'green4', Lower = 'yellow', Coral = 'magenta3', Higher = 'blue3')
)
pheatmap(heat_mat, annotation_col = annotation_col,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
labels_row = sub("_.*$", "", rownames(heat_mat)))
pheatmap(heat_mat),
annotation_col = annotation_col,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
labels_row = sub("_.*$", "", rownames(heat_mat)))
pheatmap(heat_mat)#,
all$Presence
pks <- read_tsv('PKSI_absence_presence.tsv')
pks
filter(all, Presence = 2)
filter(all, Presence == 2)
all <- bind_rows(nrps, pks, terp) %>%
mutate(uniq_id = paste(Type, FamilyID, sep = ".")) %>%
mutate(Presence = as.numeric(Presence)) %>%
group_by(Type, FamilyID) %>%
mutate(n_genomes = sum(Presence)) %>%
ungroup() %>%
filter(n_genomes > 1) %>%
mutate(Presence = ifelse(Presence == 2, yes = 1, no = Presence)#%>% ## remove singletons
#  mutate(Genome = sub(pattern = 'Attine', replacement = 'Attini', Genome))
heat <- all %>% select(Genome, uniq_id, Presence) %>%
spread(uniq_id, Presence) %>%
data.frame()
#heat[is.na(heat)] <- 0
rownames(heat) <- heat$Genome
heat$Genome <- NULL
heat_mat <- as.matrix(heat)
annotation_col = data.frame(
"BGC_Type" = sub("\\..*$", "", colnames(heat_mat)),
row.names = colnames(heat_mat)
)
#annotation_row = data.frame(
#  "Agriculture" = c(rep('Leafcutter', 4), rep('Lower', 3), rep('Coral', 2), rep('Leafcutter', 3), rep('Higher', 6)),
# row.names = rownames(heat_mat)
#)
ann_colors = list(
'BGC_Type' = c(NRPS = '#1B9E77', PKS1 = '#D95F02', Terpene = '#7570B3')#,
#  'Agriculture' = c(Leafcutter = 'green4', Lower = 'yellow', Coral = 'magenta3', Higher = 'blue3')
)
pheatmap(heat_mat)#,
annotation_col = annotation_col,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
labels_row = sub("_.*$", "", rownames(heat_mat)))
all <- bind_rows(nrps, pks, terp) %>%
mutate(uniq_id = paste(Type, FamilyID, sep = ".")) %>%
mutate(Presence = as.numeric(Presence)) %>%
group_by(Type, FamilyID) %>%
mutate(n_genomes = sum(Presence)) %>%
ungroup() %>%
filter(n_genomes > 1) %>%
mutate(Presence = ifelse(Presence == 2, yes = 1, no = Presence))#%>% ## remove singletons
heat <- all %>% select(Genome, uniq_id, Presence) %>%
spread(uniq_id, Presence) %>%
data.frame()
#heat[is.na(heat)] <- 0
rownames(heat) <- heat$Genome
heat$Genome <- NULL
heat_mat <- as.matrix(heat)
annotation_col = data.frame(
"BGC_Type" = sub("\\..*$", "", colnames(heat_mat)),
row.names = colnames(heat_mat)
)
ann_colors = list(
'BGC_Type' = c(NRPS = '#1B9E77', PKS1 = '#D95F02', Terpene = '#7570B3')#,
#  'Agriculture' = c(Leafcutter = 'green4', Lower = 'yellow', Coral = 'magenta3', Higher = 'blue3')
)
pheatmap(heat_mat)#,
pheatmap(heat_mat,
annotation_col = annotation_col,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
labels_row = sub("_.*$", "", rownames(heat_mat)))
pheatmap(heat_mat)
pheatmap(heat_mat,
annotation_col = annotation_col,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
#annotation_names_col = FALSE,
labels_row = sub("_.*$", "", rownames(heat_mat)))
pheatmap(heat_mat,
annotation_col = annotation_col,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
#labels_row = sub("_.*$", "", rownames(heat_mat))
)
pks <- read_tsv('PKSI_absence_presence.tsv') %>%
mutate(Type = 'PKS1')  %>%
gather(FamilyID, Presence, -ACC, -Type)  %>%
group_by(ACC) %>%
mutate(Genome =  munge_genome_ids(ACC)) %>%
ungroup()
nrow(pks)
terp <- read_tsv('terpene_absence_presence.tsv') %>%
mutate(Type = 'Terpene') %>%
group_by(ACC) %>%
mutate(Genome =  munge_genome_ids(ACC)) %>%
ungroup() %>%
gather(FamilyID, Presence, -ACC, -Type, -Genome)
all <- bind_rows(nrps, pks, terp) %>%
mutate(uniq_id = paste(Type, FamilyID, sep = ".")) %>%
mutate(Presence = as.numeric(Presence)) %>%
group_by(Type, FamilyID) %>%
mutate(n_genomes = sum(Presence)) %>%
ungroup() %>%
filter(n_genomes > 1) %>%
mutate(Presence = ifelse(Presence == 2, yes = 1, no = Presence))#%>% ## remove singletons
heat <- all %>% select(Genome, uniq_id, Presence) %>%
spread(uniq_id, Presence) %>%
data.frame()
#heat[is.na(heat)] <- 0
rownames(heat) <- heat$Genome
heat$Genome <- NULL
heat_mat <- as.matrix(heat)
annotation_col = data.frame(
"BGC_Type" = sub("\\..*$", "", colnames(heat_mat)),
row.names = colnames(heat_mat)
)
ann_colors = list(
'BGC_Type' = c(NRPS = '#1B9E77', PKS1 = '#D95F02', Terpene = '#7570B3')#,
#  'Agriculture' = c(Leafcutter = 'green4', Lower = 'yellow', Coral = 'magenta3', Higher = 'blue3')
)
pheatmap(heat_mat,
annotation_col = annotation_col,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
#labels_row = sub("_.*$", "", rownames(heat_mat))
)
pheatmap(heat_mat,
annotation_col = annotation_col,
cluster_cols = FALSE,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
#labels_row = sub("_.*$", "", rownames(heat_mat))
)
pheatmap(heat_mat,
annotation_col = annotation_col,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
#labels_row = sub("_.*$", "", rownames(heat_mat))
)
all <- bind_rows(nrps, pks, terp) %>%
mutate(uniq_id = paste(Type, FamilyID, sep = ".")) %>%
mutate(Presence = as.numeric(Presence)) %>%
group_by(Type, FamilyID) %>%
mutate(n_genomes = sum(Presence)) %>%
ungroup() %>%
filter(n_genomes > 2) %>%
mutate(Presence = ifelse(Presence == 2, yes = 1, no = Presence))#%>% ## remove singletons
#  mutate(Genome = sub(pattern = 'Attine', replacement = 'Attini', Genome))
heat <- all %>% select(Genome, uniq_id, Presence) %>%
spread(uniq_id, Presence) %>%
data.frame()
#heat[is.na(heat)] <- 0
rownames(heat) <- heat$Genome
heat$Genome <- NULL
heat_mat <- as.matrix(heat)
annotation_col = data.frame(
"BGC_Type" = sub("\\..*$", "", colnames(heat_mat)),
row.names = colnames(heat_mat)
)
#annotation_row = data.frame(
#  "Agriculture" = c(rep('Leafcutter', 4), rep('Lower', 3), rep('Coral', 2), rep('Leafcutter', 3), rep('Higher', 6)),
# row.names = rownames(heat_mat)
#)
ann_colors = list(
'BGC_Type' = c(NRPS = '#1B9E77', PKS1 = '#D95F02', Terpene = '#7570B3')#,
#  'Agriculture' = c(Leafcutter = 'green4', Lower = 'yellow', Coral = 'magenta3', Higher = 'blue3')
)
pheatmap(heat_mat,
annotation_col = annotation_col,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
#labels_row = sub("_.*$", "", rownames(heat_mat))
)
metadata <- read_tsv('id_metadata.txt')
head(metadata)
metadata <- read_csv('metadata.txt')
list.files()
metadata <- read_csv('metadata.csv')
head(metadata)
metadata <- read_csv('metadata.csv')
?pheatmap
head(heat_mat)
nrow(heat_mat)
head(metadata)
heat_mat <- as.matrix(heat[metadata$acc])
heat_mat <- as.matrix(heat[metadata$acc,])
head(heat_mat)
rowname(heat_mat) <- metadata$genus_species
rownames(heat_mat) <- metadata$genus_species
ann_colors = list(
'BGC_Type' = c(NRPS = '#1B9E77', PKS1 = '#D95F02', Terpene = '#7570B3')#,
#  'Agriculture' = c(Leafcutter = 'green4', Lower = 'yellow', Coral = 'magenta3', Higher = 'blue3')
)
pheatmap(heat_mat,
annotation_col = annotation_col,
cluster_rows = FALSE,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
#labels_row = sub("_.*$", "", rownames(heat_mat))
)
metadata <- read_csv('metadata.csv')
annotation_col = data.frame(
"BGC_Type" = sub("\\..*$", "", colnames(heat_mat)),
row.names = colnames(heat_mat)
)
annotation_row = data.frame(
"Agriculture" = metadata$Agriculture,
row.names = rownames(heat_mat)
)
heat_mat <- as.matrix(heat[metadata$acc,])
rownames(heat_mat) <- metadata$genus_species
ann_colors = list(
'BGC_Type' = c(NRPS = '#1B9E77', PKS1 = '#D95F02', Terpene = '#7570B3'),
'Agriculture' = c(Leafcutter = 'green4', Lower = 'yellow', Coral = 'magenta3', Higher = 'blue3')
)
pheatmap(heat_mat,
annotation_col = annotation_col,
cluster_rows = FALSE,
#        annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
#labels_row = sub("_.*$", "", rownames(heat_mat))
)
ann_colors = list(
'BGC_Type' = c(NRPS = '#1B9E77', PKS1 = '#D95F02', Terpene = '#7570B3'),
'Agriculture' = c(Leafcutter = 'green4', Lower = 'yellow', Coral = 'magenta3', Higher = 'blue3', NA = 'black')
)
ann_colors = list(
'BGC_Type' = c(NRPS = '#1B9E77', PKS1 = '#D95F02', Terpene = '#7570B3'),
'Agriculture' = c(Leafcutter = 'green4', Lower = 'yellow', Coral = 'magenta3', Higher = 'blue3', 'NA' = 'black')
)
pheatmap(heat_mat,
annotation_col = annotation_col,
cluster_rows = FALSE,
annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
#labels_row = sub("_.*$", "", rownames(heat_mat))
)
ann_colors = list(
'BGC_Type' = c(NRPS = '#1B9E77', PKS1 = '#D95F02', Terpene = '#7570B3'),
'Agriculture' = c(Leafcutter = 'green4', Lower = 'yellow', Coral = 'magenta3', Higher = 'blue3', 'NA' = 'white')
)
pheatmap(heat_mat,
annotation_col = annotation_col,
cluster_rows = FALSE,
annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
#labels_row = sub("_.*$", "", rownames(heat_mat))
)
pheatmap(heat_mat,
annotation_col = annotation_col,
#         cluster_rows = FALSE,
annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
#labels_row = sub("_.*$", "", rownames(heat_mat))
)
pheatmap(heat_mat,
annotation_col = annotation_col,
#         cluster_rows = FALSE,
annotation_row = annotation_row,
border_color = "grey70",
cellwidth = 7,
cellheight = 10,
show_colnames = FALSE,
annotation_colors = ann_colors,
color = c('grey87', 'black'), legend = FALSE,
annotation_names_row = FALSE,
annotation_names_col = FALSE,
filename = 'bgc_heat.pdf'
#labels_row = sub("_.*$", "", rownames(heat_mat))
)
